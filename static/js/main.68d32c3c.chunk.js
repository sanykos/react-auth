(this["webpackJsonpreact-auth"]=this["webpackJsonpreact-auth"]||[]).push([[0],{41:function(e,t,a){e.exports=a(73)},46:function(e,t,a){},51:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(18),c=a.n(o),l=(a(46),a(7)),u=a(8),i=a(10),s=a(9),m=a(2),d=a(12),h=a(14);a(51);function p(e){var t=e.valid,a=e.touched,n=e.shouldValidate;return!t&&n&&a}var v=function(e){var t=e.type||"text",a=["form-group"],n="".concat(t,"-").concat(Math.random());return p(e)&&a.push("invalid"),r.a.createElement("div",{className:a.join(" ")},r.a.createElement("label",{htmlFor:n},e.label),r.a.createElement("input",{type:t,id:n,className:"form-control",value:e.value,onChange:e.onChange,placeholder:e.placeholder}),p(e)&&r.a.createElement("span",{className:""},e.errorMessage||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0435\u0440\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"))},b=a(23),f=a.n(b),E=a(36),g=a(37),O=a.n(g).a.create({baseURL:"http://emphasoft-test-assignment.herokuapp.com"});function y(e){return{type:"AUTH_SUCCESS",token:e}}function j(){return localStorage.removeItem("Token"),{type:"AUTH_LOGOUT"}}var k=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isFormValid:!1,formControls:{username:{value:"",type:"username",label:"username",placeholder:"Enter username",errorMessage:"\u0412\u0432\u0435\u0434\u0435\u0442\u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",valid:!1,touched:!1,validation:{required:!0,minLength:1}},password:{value:"",type:"password",label:"password",placeholder:"Enter password",errorMessage:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",valid:!1,touched:!1,validation:{required:!0,minLength:1}}}},e.handleSubmit=function(t){t.preventDefault(),e.props.login(e.state.formControls.username.value,e.state.formControls.password.value,!0)},e.onChangeHandler=function(t,a){var n=Object(h.a)({},e.state.formControls),r=Object(h.a)({},n[a]);r.value=t.target.value,r.touched=!0,r.valid=e.validateControl(r.value,r.validation),n[a]=r;var o=!0;Object.keys(n).forEach((function(e){o=n[e].valid&&o})),e.setState({formControls:n,isFormValid:o})},e}return Object(u.a)(a,[{key:"validateControl",value:function(e,t){if(!t)return!0;var a=!0;return t.required&&(a=""!==e.trim()&&a),t.minLength&&(a=e.length>=t.minLength&&a),a}},{key:"renderInputs",value:function(){var e=this;return Object.keys(this.state.formControls).map((function(t,a){var n=e.state.formControls[t];return r.a.createElement(v,{key:t+a,type:n.type,value:n.value,valid:n.valid,touched:n.touched,onChange:function(a){return e.onChangeHandler(a,t)},label:n.label,placeholder:n.placeholder,shouldValidate:!!n.validation,errorMessage:n.errorMessage})}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInputs(),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!this.state.isFormValid},"\u0412\u043e\u0439\u0442\u0438")))}}]),a}(n.Component);var C=Object(d.b)(null,(function(e){return{login:function(t,a,n){return e(function(e,t,a){return function(){var a=Object(E.a)(f.a.mark((function a(n){var r,o,c;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r={username:e,password:t},a.next=3,O.post("/api-token-auth/",r);case 3:o=a.sent,c=o.data.token,localStorage.setItem("Token",c),n(y(c));case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}(t,a))}}}))(k),S=a(38),w=a.n(S),_=function(e){return r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"first_name"),r.a.createElement("th",{onClick:e.onSort.bind(null,"id")},"id",r.a.createElement("sup",null,e.sort)),r.a.createElement("th",null,"last_name"),r.a.createElement("th",null,"username"))),r.a.createElement("tbody",null,e.data.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.first_name),r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.last_name),r.a.createElement("td",null,e.username))}))))},L=a(40),N=function(e){var t=Object(n.useState)(""),a=Object(L.a)(t,2),o=a[0],c=a[1];return r.a.createElement("div",{className:"input-group mb-3 mt-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){return e.onSearch(o)}},"Button")),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"","aria-label":"","aria-describedby":"basic-addon1",onChange:function(e){c(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&e.onSearch(o)},value:o}))},x=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1,data:[],search:"",sort:"asc",sortField:"id"},e.onSort=function(t){var a=e.state.data.concat(),n="asc"===e.state.sort?"desc":"asc",r=w.a.orderBy(a,t,n);e.setState({data:r,sort:n,sortField:t})},e.searchHandler=function(t){e.setState({search:t})},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("Token");O.get("/api/v1/users/",{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}}).then((function(t){var a=t.data;e.setState({data:a})})).catch((function(e){console.log(e)}))}},{key:"getFilteredData",value:function(){var e=this.state,t=e.data,a=e.search;return a?t.filter((function(e){return e.username.toLowerCase().includes(a.toLowerCase())})):t}},{key:"render",value:function(){var e=this.getFilteredData();return r.a.createElement(n.Fragment,null,r.a.createElement(N,{onSearch:this.searchHandler}),r.a.createElement(_,{data:e,onSort:this.onSort,sort:this.state.sort,sortField:this.state.sortField}))}}]),a}(n.Component),T=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.logout()}},{key:"render",value:function(){return r.a.createElement(m.a,{to:"/"})}}]),a}(n.Component);var A=Object(d.b)(null,(function(e){return{logout:function(){return e(j())}}}))(T),F=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("h1",null,"React auth test")}}]),a}(n.Component),M=a(16),U=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"renderLinks",value:function(e){return e.map((function(e,t){return r.a.createElement("li",{key:t,className:"nav-item"},r.a.createElement(M.b,{to:e.to,exact:e.exact,className:"nav-link"},e.label))}))}},{key:"render",value:function(){var e=[{to:"/",label:"Home",exact:!0}];return this.props.isAuthenticated?(e.push({to:"/users",label:"Users",exact:!1}),e.push({to:"/logout",label:"Logout",exact:!1})):e.push({to:"/login",label:"Login",exact:!1}),r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("ul",{className:"navbar-nav"},this.renderLinks(e))))}}]),a}(n.Component),D=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.autoLogin()}},{key:"render",value:function(){var e=r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/login",component:C,exact:!1}),r.a.createElement(m.b,{path:"/",component:F,exact:!0}),r.a.createElement(m.a,{to:"/"}));return this.props.isAuthenticated&&(e=r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/",component:F,exact:!0}),r.a.createElement(m.b,{path:"/users",component:x,exact:!1}),r.a.createElement(m.b,{path:"/logout",component:A,exact:!1}),r.a.createElement(m.a,{to:"/"}))),r.a.createElement("div",{className:"container"},r.a.createElement(U,{isAuthenticated:this.props.isAuthenticated}),e)}}]),a}(n.Component);var H=Object(m.g)(Object(d.b)((function(e){return{isAuthenticated:!!e.login.token}}),(function(e){return{autoLogin:function(){return e((function(e){var t=localStorage.getItem("Token");e(t?y(t):j())}))}}}))(D));a(72),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I=a(13),V=a(39),B={token:""};var R=Object(I.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_SUCCESS":return Object(h.a)(Object(h.a)({},e),{},{token:t.token});case"AUTH_LOGOUT":return Object(h.a)(Object(h.a)({},e),{},{token:null});default:return e}}}),X="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):I.d;var q=Object(I.e)(R,X(Object(I.a)((function(e){return function(t){return function(a){var n=t(a);return console.log("Middleware",e.getState()),n}}}),V.a))),P=r.a.createElement(M.a,null,r.a.createElement(d.a,{store:q},r.a.createElement(H,null)));c.a.render(P,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.68d32c3c.chunk.js.map